# RiverCiliwung
![ciliwungcatchment](figs/TBD.png)

Contributors: Nico Septianus, Onno Bokhove

Instruction for the code:

1.) The data and the code is inside Ciliwungcode1.xslm

2.) Open the developer tab and open visual basic.

3.) On the top right hand side there is arrow bar where you can choose any function to call.

Below is the function correspond to the results (function name -> graph name):

equation2 -> the 3-panel graph (exclude the FEV shaded region).

shadedarea -> the FEV shaded region (blue).

mitigation -> the mitigation scheme (the colour is manually added).

threedshape -> 2-meter deep square lake.

FEV -> FEV-ht and 2-meter deep square - ht graph.

ratingcurve -> only the rating curve graph.

PS: After you call the function, you need to delete the existing graph before run the function again, since the nickname of the graph already exist, unless you change the nickname of the graph in the code. Added is -readertest to show that the graph is call by you.


## TBD: FEV analysis using VBA/Excel for 2020 flood of River Ciliwung (Djakarta, Indonesia)

Work published as: 

TBD

*Above figure TBD

See also:
* 'Using flood-excess volume to assess and communicate flood-mitigation schemes': [presentation](http://www1.maths.leeds.ac.uk/~amttk/files/leedskyoto.pdf) and [poster](http://www1.maths.leeds.ac.uk/~amttk/files/INI_sept2018.pdf). 

### Graphical output 

#### Data analysis: from depth to discharge to FEV

From the ```/code``` dir, run: 
 * ```TBD``` 
 
The Excel/VBA script completes the FEV analysis and calls four plotting routines:
 * ```TBD;```
`
 
in total, N figures are produced, including an adaptation of TBD:

![3panel](figs/ciliwung3p.png)

*Caption: TBD*

#### Cost-effectiveness analysis

Run ```TBD``` to produce figure N of TBD:

![floodscheme](figs/TBD)

*Caption: TBD*
